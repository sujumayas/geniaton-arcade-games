<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Bias Bug Hunt</title>
  <style>
    body {
      margin: 0;
      font-family: 'Courier New', Courier, monospace;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
      color: #00ff41;
      overflow: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #gameContainer {
      width: 1000px;
      height: 700px;
      border: 2px solid #00ff41;
      border-radius: 15px;
      box-shadow: 0 0 40px rgba(0, 255, 65, 0.3);
      background: rgba(0, 0, 0, 0.9);
      position: relative;
      overflow: hidden;
    }

    .screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 20;
      backdrop-filter: blur(5px);
    }

    .screen h1 {
      font-size: 48px;
      margin-bottom: 20px;
      text-shadow: 0 0 20px #00ff41;
      text-align: center;
      color: #00ff41;
    }

    .screen p {
      font-size: 18px;
      text-align: center;
      margin: 10px 0;
      max-width: 700px;
      line-height: 1.5;
    }

    .screen button {
      padding: 15px 30px;
      background: transparent;
      border: 2px solid #00ff41;
      color: #00ff41;
      font-family: 'Courier New', Courier, monospace;
      font-size: 16px;
      cursor: pointer;
      margin: 10px;
      transition: all 0.3s;
      border-radius: 8px;
    }

    .screen button:hover {
      background: #00ff41;
      color: #000;
      box-shadow: 0 0 15px #00ff41;
    }

    .hidden {
      display: none;
    }

    #gameArea {
      width: 100%;
      height: 100%;
      position: relative;
    }

    #codeEditor {
      width: 100%;
      height: calc(100% - 80px);
      background: #0a0a0a;
      border: none;
      color: #00ff41;
      font-family: 'Courier New', Courier, monospace;
      font-size: 14px;
      padding: 20px;
      box-sizing: border-box;
      overflow-y: auto;
      line-height: 1.4;
      position: relative;
    }

    #ui {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 80px;
      background: rgba(0, 0, 0, 0.8);
      border-bottom: 1px solid #00ff41;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      z-index: 10;
    }

    .bias-bug {
      background: rgba(255, 0, 0, 0.3);
      border: 1px solid #ff0000;
      border-radius: 3px;
      cursor: crosshair;
      position: relative;
      display: inline-block;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }

    .bias-bug:hover {
      background: rgba(255, 0, 0, 0.5);
      box-shadow: 0 0 10px #ff0000;
    }

    .found {
      background: rgba(0, 255, 65, 0.3) !important;
      border-color: #00ff41 !important;
      animation: found 0.5s;
    }

    @keyframes found {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    #timer {
      font-size: 24px;
      color: #ff9800;
      font-weight: bold;
    }

    .timer-warning {
      color: #f44336 !important;
      animation: blink 1s infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0.3; }
    }

    #score {
      color: #00ff41;
      font-weight: bold;
    }

    .code-line {
      display: block;
      margin: 2px 0;
      padding: 2px 0;
    }

    .line-number {
      color: #666;
      margin-right: 15px;
      user-select: none;
    }

    .comment {
      color: #888;
    }

    .string {
      color: #ffa726;
    }

    .keyword {
      color: #42a5f5;
    }

    .function {
      color: #ab47bc;
    }

    #tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.9);
      border: 1px solid #00ff41;
      border-radius: 5px;
      padding: 10px;
      color: #00ff41;
      font-size: 12px;
      max-width: 300px;
      z-index: 100;
      display: none;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div id="startScreen" class="screen">
      <h1>üêõ BIAS BUG HUNT</h1>
      <p>Welcome to the AI Ethics Debugging Chamber!</p>
      <p>Hunt down bias bugs in AI code before time runs out!</p>
      <p>üîç Spot problematic assumptions in AI output</p>
      <p>‚ö° Click bias bugs to eliminate them</p>
      <p>‚è∞ 60 seconds per round ‚Ä¢ 3 rounds total</p>
      <button onclick="startGame()">START DEBUGGING</button>
      <a href="index.html" style="padding: 15px 30px; background: transparent; border: 2px solid #f00; color: #f00; font-family: 'Courier New', Courier, monospace; font-size: 16px; cursor: pointer; margin: 10px; transition: all 0.3s; text-decoration: none; display: inline-block;">‚Üê ALL GAMES</a>
    </div>

    <div id="pauseScreen" class="screen hidden">
      <h1>‚è∏Ô∏è DEBUGGING PAUSED</h1>
      <p>System halted. Ready to resume the hunt?</p>
      <button onclick="resumeGame()">RESUME</button>
      <button onclick="showStart()">RESTART</button>
    </div>

    <div id="gameOverScreen" class="screen hidden">
      <h1 id="gameOverTitle">üéâ DEBUGGING COMPLETE!</h1>
      <p>Bugs Found: <span id="finalScore"></span></p>
      <p>Accuracy: <span id="accuracy"></span>%</p>
      <p id="performanceText"></p>
      <button onclick="showStart()">RESTART</button>
    </div>

    <div id="gameArea" class="hidden">
      <div id="ui">
        <div>Round: <span id="roundText">1</span>/3</div>
        <div id="timer">60</div>
        <div>Bugs Found: <span id="score">0</span>/<span id="totalBugs">0</span></div>
      </div>

      <div id="codeEditor"></div>
    </div>

    <div id="tooltip"></div>
  </div>

  <script>
    let gameState = 'start';
    let currentRound = 1;
    let score = 0;
    let timeLeft = 60;
    let timer = null;
    let isPaused = false;
    let totalBugs = 0;
    let bugsFound = 0;
    let totalRounds = 3;
    let wrongClicks = 0;

    const codeExamples = [
      {
        title: "AI Hiring System",
        code: `function evaluateCandidate(resume) {
    let score = 0;

    // Education scoring
    if (resume.education.includes("Harvard") ||
        resume.education.includes("MIT")) {
        score += 50; // <bias>Elite university bias</bias>
    }

    // Name bias check
    if (<bias>isAmericanName(resume.name)</bias>) {
        score += 10; // <bias>Cultural name bias</bias>
    }

    // Experience evaluation
    if (resume.yearsExperience > 5) {
        score += 30;
    }

    // Gender assumption
    if (<bias>resume.name.endsWith("son")</bias>) {
        score += 5; // <bias>Gender surname bias</bias>
    }

    return score;
}`,
        biases: [
            "Elite university bias - assumes expensive schools = better candidates",
            "Cultural name bias - discriminates against non-American names",
            "Gender surname bias - makes assumptions based on surname patterns"
        ]
      },
      {
        title: "Healthcare AI Diagnosis",
        code: `function diagnosePatient(symptoms, demographics) {
    let diagnosis = "";

    if (symptoms.includes("chest pain")) {
        if (<bias>demographics.gender === "male"</bias>) {
            diagnosis = "probable heart attack";
        } else {
            diagnosis = <bias>"anxiety or stress"</bias>; // <bias>Gender medical bias</bias>
        }
    }

    if (symptoms.includes("fatigue")) {
        if (<bias>demographics.age > 60</bias>) {
            return <bias>"normal aging"</bias>; // <bias>Ageism in healthcare</bias>
        }
    }

    // Income-based treatment
    if (<bias>demographics.insurance === "premium"</bias>) {
        diagnosis += " - recommend specialist"; // <bias>Healthcare access bias</bias>
    }

    return diagnosis;
}`,
        biases: [
            "Gender medical bias - different diagnoses for same symptoms",
            "Ageism in healthcare - dismissing symptoms as 'normal aging'",
            "Healthcare access bias - different care based on insurance"
        ]
      },
      {
        title: "Content Moderation AI",
        code: `function moderateContent(post, userProfile) {
    let riskScore = 0;

    // Language analysis
    if (<bias>detectForeignLanguage(post.text)</bias>) {
        riskScore += 20; // <bias>Language discrimination</bias>
    }

    // User profiling
    if (<bias>userProfile.location.includes("developing")</bias>) {
        riskScore += 15; // <bias>Geographic bias</bias>
    }

    // Content type bias
    if (post.topic === "politics" &&
        <bias>userProfile.age < 25</bias>) {
        riskScore += 10; // <bias>Age-based censorship</bias>
    }

    // Religious content
    if (<bias>post.mentions.includes("minority_religion")</bias>) {
        riskScore += 25; // <bias>Religious bias</bias>
    }

    return riskScore > 30 ? "BLOCKED" : "APPROVED";
}`
        biases: [
            "Language discrimination - penalizing non-English content",
            "Geographic bias - discriminating against developing countries",
            "Age-based censorship - limiting young people's political speech",
            "Religious bias - targeting minority religious content"
        ]
      }
    ];

    function startGame() {
      hideAllScreens();
      document.getElementById('gameArea').classList.remove('hidden');
      gameState = 'playing';
      currentRound = 1;
      score = 0;
      bugsFound = 0;
      wrongClicks = 0;
      nextRound();
    }

    function pauseGame() {
      if (gameState === 'playing') {
        isPaused = true;
        clearInterval(timer);
        document.getElementById('pauseScreen').classList.remove('hidden');
      }
    }

    function resumeGame() {
      isPaused = false;
      document.getElementById('pauseScreen').classList.add('hidden');
      startTimer();
    }

    function showStart() {
      hideAllScreens();
      gameState = 'start';
      document.getElementById('startScreen').classList.remove('hidden');
      clearInterval(timer);
    }

    function hideAllScreens() {
      document.querySelectorAll('.screen').forEach(screen => {
        screen.classList.add('hidden');
      });
    }

    function nextRound() {
      if (currentRound > totalRounds) {
        gameComplete();
        return;
      }

      const example = codeExamples[currentRound - 1];
      displayCode(example);

      document.getElementById('roundText').textContent = currentRound;
      timeLeft = 60;
      startTimer();
    }

    function displayCode(example) {
      const editor = document.getElementById('codeEditor');

      // Parse and highlight code
      let lines = example.code.split('\n');
      let html = '';
      let lineNumber = 1;
      let biasCount = 0;

      lines.forEach(line => {
        // Count bias tags for this round
        const biasMatches = line.match(/<bias>/g);
        if (biasMatches) {
          biasCount += biasMatches.length;
        }

        // Convert bias tags to clickable elements
        let processedLine = line
          .replace(/<bias>(.*?)<\/bias>/g, '<span class="bias-bug" data-bias="$1">$1</span>')
          .replace(/\/\/(.*?)$/g, '<span class="comment">//$1</span>')
          .replace(/"(.*?)"/g, '<span class="string">"$1"</span>')
          .replace(/\b(function|if|else|return|let|const|var)\b/g, '<span class="keyword">$1</span>')
          .replace(/\b(\w+)\(/g, '<span class="function">$1</span>(');

        html += `<div class="code-line">
          <span class="line-number">${lineNumber.toString().padStart(2, ' ')}</span>
          ${processedLine}
        </div>`;
        lineNumber++;
      });

      editor.innerHTML = html;
      totalBugs = biasCount;
      bugsFound = 0;
      updateScore();

      // Add click handlers to bias bugs
      document.querySelectorAll('.bias-bug').forEach(bug => {
        bug.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();
          foundBias(bug);
        });

        bug.addEventListener('mouseenter', (e) => {
          showTooltip(e, "Click to eliminate this bias bug!");
        });

        bug.addEventListener('mouseleave', hideTooltip);
      });

      // Add click handler for wrong clicks
      editor.addEventListener('click', (e) => {
        if (!e.target.classList.contains('bias-bug')) {
          wrongClick(e);
        }
      });
    }

    function foundBias(element) {
      if (element.classList.contains('found')) return;

      element.classList.add('found');
      bugsFound++;
      score++;
      updateScore();

      // Show explanation tooltip
      const biasText = element.getAttribute('data-bias');
      showTooltip(event, `‚úì BIAS ELIMINATED: ${biasText}`, 2000);

      if (bugsFound >= totalBugs) {
        setTimeout(() => {
          currentRound++;
          if (currentRound <= totalRounds) {
            nextRound();
          } else {
            gameComplete();
          }
        }, 1000);
      }
    }

    function wrongClick(e) {
      wrongClicks++;
      showTooltip(e, "‚ùå Not a bias bug! Look for problematic assumptions.", 1000);
    }

    function showTooltip(event, text, duration = 0) {
      const tooltip = document.getElementById('tooltip');
      tooltip.textContent = text;
      tooltip.style.display = 'block';
      tooltip.style.left = event.clientX + 10 + 'px';
      tooltip.style.top = event.clientY - 30 + 'px';

      if (duration > 0) {
        setTimeout(hideTooltip, duration);
      }
    }

    function hideTooltip() {
      document.getElementById('tooltip').style.display = 'none';
    }

    function updateScore() {
      document.getElementById('score').textContent = bugsFound;
      document.getElementById('totalBugs').textContent = totalBugs;
    }

    function startTimer() {
      clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        const timerElement = document.getElementById('timer');
        timerElement.textContent = timeLeft;

        if (timeLeft <= 10) {
          timerElement.classList.add('timer-warning');
        } else {
          timerElement.classList.remove('timer-warning');
        }

        if (timeLeft <= 0) {
          timeOut();
        }
      }, 1000);
    }

    function timeOut() {
      clearInterval(timer);
      currentRound++;
      if (currentRound <= totalRounds) {
        setTimeout(nextRound, 1000);
      } else {
        gameComplete();
      }
    }

    function gameComplete() {
      gameState = 'complete';
      hideAllScreens();

      const totalPossibleBugs = codeExamples.reduce((sum, ex) => {
        return sum + (ex.code.match(/<bias>/g) || []).length;
      }, 0);

      const accuracy = Math.round((score / totalPossibleBugs) * 100);

      document.getElementById('finalScore').textContent = `${score}/${totalPossibleBugs}`;
      document.getElementById('accuracy').textContent = accuracy;

      let performanceText = '';
      if (accuracy >= 90) {
        performanceText = 'üèÜ EXPERT DEBUGGER! You have a keen eye for bias detection!';
      } else if (accuracy >= 70) {
        performanceText = 'üîç SKILLED HUNTER! Good bias detection abilities!';
      } else if (accuracy >= 50) {
        performanceText = 'üìñ LEARNING DEBUGGER! Keep practicing bias identification!';
      } else {
        performanceText = 'üéØ NOVICE HUNTER! Study more about AI bias patterns!';
      }

      document.getElementById('performanceText').textContent = performanceText;
      document.getElementById('gameOverScreen').classList.remove('hidden');
    }

    // Event listeners
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (gameState === 'playing' && !isPaused) {
          pauseGame();
        } else if (isPaused) {
          resumeGame();
        }
      }
    });
  </script>
</body>
</html>