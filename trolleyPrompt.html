<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Trolley Prompt</title>
  <style>
    body {
      margin: 0;
      font-family: 'Courier New', Courier, monospace;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%);
      color: #ecf0f1;
      overflow: hidden;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #gameContainer {
      width: 1000px;
      height: 700px;
      border: 2px solid #e74c3c;
      border-radius: 15px;
      box-shadow: 0 0 40px rgba(231, 76, 60, 0.3);
      background: rgba(0, 0, 0, 0.8);
      position: relative;
      overflow: hidden;
    }

    .screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 20;
      backdrop-filter: blur(10px);
    }

    .screen h1 {
      font-size: 48px;
      margin-bottom: 20px;
      text-shadow: 0 0 20px #e74c3c;
      text-align: center;
      color: #e74c3c;
    }

    .screen p {
      font-size: 18px;
      text-align: center;
      margin: 10px 0;
      max-width: 700px;
      line-height: 1.6;
    }

    .screen button {
      padding: 15px 30px;
      background: transparent;
      border: 2px solid #e74c3c;
      color: #e74c3c;
      font-family: 'Courier New', Courier, monospace;
      font-size: 16px;
      cursor: pointer;
      margin: 10px;
      transition: all 0.3s;
      border-radius: 8px;
    }

    .screen button:hover {
      background: #e74c3c;
      color: #fff;
      box-shadow: 0 0 15px #e74c3c;
    }

    .hidden {
      display: none;
    }

    #gameArea {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
    }

    #scenarioHeader {
      height: 80px;
      background: rgba(0, 0, 0, 0.7);
      border-bottom: 1px solid #e74c3c;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 30px;
    }

    #scenarioMain {
      flex: 1;
      display: flex;
      padding: 30px;
      gap: 30px;
    }

    #trolleyScene {
      flex: 1;
      background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
      border: 1px solid #e74c3c;
      border-radius: 10px;
      position: relative;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 48px;
    }

    #decisionPanel {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .scenario-text {
      background: rgba(231, 76, 60, 0.1);
      border: 1px solid #e74c3c;
      border-radius: 10px;
      padding: 20px;
      line-height: 1.6;
      max-height: 200px;
      overflow-y: auto;
    }

    .prompt-input {
      flex: 1;
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid #e74c3c;
      border-radius: 10px;
      color: #ecf0f1;
      font-family: 'Courier New', Courier, monospace;
      font-size: 14px;
      padding: 15px;
      resize: none;
    }

    .prompt-input:focus {
      outline: none;
      box-shadow: 0 0 15px rgba(231, 76, 60, 0.5);
    }

    .prompt-input::placeholder {
      color: rgba(236, 240, 241, 0.5);
    }

    .decision-buttons {
      display: flex;
      gap: 15px;
    }

    .decision-btn {
      flex: 1;
      padding: 15px;
      background: transparent;
      border: 2px solid #3498db;
      color: #3498db;
      font-family: 'Courier New', Courier, monospace;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s;
      font-size: 14px;
    }

    .decision-btn:hover {
      background: rgba(52, 152, 219, 0.2);
      box-shadow: 0 0 10px #3498db;
    }

    .decision-btn.selected {
      background: #3498db;
      color: #fff;
    }

    .submit-area {
      display: flex;
      gap: 15px;
    }

    .submit-btn {
      padding: 15px 30px;
      background: #27ae60;
      border: none;
      color: #fff;
      font-family: 'Courier New', Courier, monospace;
      cursor: pointer;
      border-radius: 8px;
      transition: all 0.3s;
      font-weight: bold;
    }

    .submit-btn:hover {
      background: #2ecc71;
      box-shadow: 0 0 10px #27ae60;
    }

    .submit-btn:disabled {
      background: #7f8c8d;
      cursor: not-allowed;
    }

    .timer {
      font-size: 24px;
      color: #f39c12;
      font-weight: bold;
    }

    .timer.warning {
      color: #e74c3c;
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .results-panel {
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid #e74c3c;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
    }

    .vote-display {
      display: flex;
      justify-content: space-around;
      margin: 15px 0;
    }

    .vote-option {
      text-align: center;
      padding: 10px;
      border-radius: 8px;
      background: rgba(52, 152, 219, 0.1);
      border: 1px solid #3498db;
      flex: 1;
      margin: 0 5px;
    }

    .vote-count {
      font-size: 24px;
      font-weight: bold;
      color: #3498db;
    }

    .philosophical-insight {
      background: rgba(155, 89, 182, 0.1);
      border: 1px solid #9b59b6;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      font-style: italic;
    }

    .next-round-btn {
      width: 100%;
      padding: 15px;
      background: #8e44ad;
      border: none;
      color: #fff;
      font-family: 'Courier New', Courier, monospace;
      cursor: pointer;
      border-radius: 8px;
      margin-top: 15px;
      font-weight: bold;
    }

    .trolley {
      position: absolute;
      font-size: 32px;
      animation: trolleyMove 4s linear infinite;
    }

    @keyframes trolleyMove {
      0% { left: -50px; }
      100% { left: calc(100% + 50px); }
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div id="startScreen" class="screen">
      <h1>üöã THE TROLLEY PROMPT</h1>
      <p>Welcome to the ultimate AI ethics challenge!</p>
      <p>ü§î Face complex moral dilemmas involving AI systems</p>
      <p>‚úçÔ∏è Craft the perfect prompt to navigate ethical minefields</p>
      <p>üó≥Ô∏è Vote on the best solutions with other players</p>
      <p>üìö Learn philosophy while debugging AI morality</p>
      <p>5 rounds of ethical decision-making await!</p>
      <button onclick="startGame()">ENTER MORAL MAZE</button>
      <a href="index.html" style="padding: 15px 30px; background: transparent; border: 2px solid #ff6600; color: #ff6600; font-family: 'Courier New', Courier, monospace; font-size: 16px; cursor: pointer; margin: 10px; transition: all 0.3s; text-decoration: none; display: inline-block;">‚Üê ALL GAMES</a>
    </div>

    <div id="pauseScreen" class="screen hidden">
      <h1>‚è∏Ô∏è ETHICS PAUSED</h1>
      <p>Moral reasoning suspended...</p>
      <button onclick="resumeGame()">RESUME</button>
      <button onclick="showStart()">RESTART</button>
    </div>

    <div id="gameOverScreen" class="screen hidden">
      <h1>üéì PHILOSOPHY COMPLETE!</h1>
      <p>Total Ethics Score: <span id="finalEthicsScore">0</span>/100</p>
      <p>Philosophical Alignment: <span id="alignment"></span></p>
      <p id="finalInsight"></p>
      <button onclick="showStart()">RESTART</button>
    </div>

    <div id="gameArea" class="hidden">
      <div id="scenarioHeader">
        <div>Round: <span id="roundText">1</span>/5</div>
        <div class="timer" id="timer">120</div>
        <div>Ethics Score: <span id="ethicsScore">0</span></div>
      </div>

      <div id="scenarioMain">
        <div id="trolleyScene">
          <div class="trolley">üöã</div>
          <div id="sceneEmoji">‚ö°</div>
        </div>

        <div id="decisionPanel">
          <div class="scenario-text" id="scenarioText">
            Loading ethical dilemma...
          </div>

          <textarea
            class="prompt-input"
            id="promptInput"
            placeholder="Craft your AI prompt to handle this ethical dilemma..."
            maxlength="300"
          ></textarea>

          <div class="decision-buttons" id="decisionButtons">
            <!-- Decision options will be populated here -->
          </div>

          <div class="submit-area">
            <button class="submit-btn" id="submitBtn" onclick="submitDecision()">
              SUBMIT DECISION
            </button>
          </div>

          <div id="resultsPanel" class="results-panel hidden">
            <!-- Results will appear here -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let gameState = 'start';
    let currentRound = 1;
    let timeLeft = 120;
    let timer = null;
    let isPaused = false;
    let ethicsScore = 0;
    let selectedDecision = null;
    let currentScenario = null;

    const scenarios = [
      {
        title: "Autonomous Vehicle Dilemma",
        scene: "üöóüí•üë•",
        text: "An AI-controlled car must choose between hitting 1 elderly person or 3 young adults. The AI needs instructions on how to make this decision. How do you prompt the AI to handle this impossible choice?",
        options: [
          { text: "Minimize total casualties", value: "utilitarian" },
          { text: "Protect the most vulnerable", value: "duty" },
          { text: "Random selection", value: "neutral" },
          { text: "Let human override", value: "human" }
        ],
        philosophy: "This explores utilitarian vs. deontological ethics in AI decision-making.",
        insight: "Real-world AI systems face these dilemmas daily. How we program them reflects our moral values."
      },
      {
        title: "Healthcare AI Resource Allocation",
        scene: "üè•‚öïÔ∏èüíä",
        text: "During a pandemic, an AI system must allocate limited ventilators. It has data on age, health status, and 'social value.' How do you prompt the AI to make fair decisions?",
        options: [
          { text: "First come, first served", value: "procedural" },
          { text: "Greatest chance of survival", value: "utilitarian" },
          { text: "Ignore social factors", value: "egalitarian" },
          { text: "Equal lottery system", value: "random" }
        ],
        philosophy: "This examines distributive justice and the value of human life in AI systems.",
        insight: "AI bias in healthcare can literally be life or death. Fairness metrics must be carefully designed."
      },
      {
        title: "Social Media Content Moderation",
        scene: "üì±üí¨üö´",
        text: "An AI content moderator must decide whether to remove a post that contains historical facts that could be misinterpreted as hate speech. How do you balance free speech with harm prevention?",
        options: [
          { text: "Remove potentially harmful content", value: "safety" },
          { text: "Preserve free speech", value: "liberty" },
          { text: "Add warning labels", value: "compromise" },
          { text: "Context-dependent decisions", value: "contextual" }
        ],
        philosophy: "This addresses the tension between liberty and safety in AI-mediated communication.",
        insight: "Content moderation AI shapes public discourse. These decisions affect millions of conversations daily."
      },
      {
        title: "AI Hiring Algorithm",
        scene: "üíºüëîüìä",
        text: "Your AI hiring system shows bias against certain demographic groups, but removing demographic data reduces overall hiring quality. How do you prompt for fairness?",
        options: [
          { text: "Optimize for best candidates", value: "meritocracy" },
          { text: "Ensure demographic balance", value: "equality" },
          { text: "Use bias correction algorithms", value: "technical" },
          { text: "Human-AI hybrid decisions", value: "collaborative" }
        ],
        philosophy: "This explores equality vs. merit-based selection in algorithmic decision-making.",
        insight: "AI hiring tools can perpetuate historical biases or create new forms of discrimination."
      },
      {
        title: "Privacy vs. Public Safety",
        scene: "üîíüëÅÔ∏èüõ°Ô∏è",
        text: "An AI surveillance system can prevent terrorist attacks but requires analyzing everyone's private communications. How do you prompt the AI to balance privacy and security?",
        options: [
          { text: "Maximum security", value: "security" },
          { text: "Absolute privacy", value: "privacy" },
          { text: "Targeted surveillance only", value: "selective" },
          { text: "Democratic oversight", value: "democratic" }
        ],
        philosophy: "This examines the classic privacy vs. security dilemma in the age of AI.",
        insight: "Surveillance AI systems must navigate constitutional rights while protecting public safety."
      }
    ];

    function startGame() {
      hideAllScreens();
      document.getElementById('gameArea').classList.remove('hidden');
      gameState = 'playing';
      currentRound = 1;
      ethicsScore = 0;
      nextRound();
    }

    function pauseGame() {
      if (gameState === 'playing') {
        isPaused = true;
        clearInterval(timer);
        document.getElementById('pauseScreen').classList.remove('hidden');
      }
    }

    function resumeGame() {
      isPaused = false;
      document.getElementById('pauseScreen').classList.add('hidden');
      startTimer();
    }

    function showStart() {
      hideAllScreens();
      gameState = 'start';
      document.getElementById('startScreen').classList.remove('hidden');
      clearInterval(timer);
    }

    function hideAllScreens() {
      document.querySelectorAll('.screen').forEach(screen => {
        screen.classList.add('hidden');
      });
    }

    function nextRound() {
      if (currentRound > 5) {
        gameComplete();
        return;
      }

      currentScenario = scenarios[currentRound - 1];
      selectedDecision = null;

      document.getElementById('roundText').textContent = currentRound;
      document.getElementById('sceneEmoji').textContent = currentScenario.scene;
      document.getElementById('scenarioText').textContent = currentScenario.text;
      document.getElementById('promptInput').value = '';
      document.getElementById('resultsPanel').classList.add('hidden');

      setupDecisionButtons();
      updateUI();

      timeLeft = 120;
      startTimer();
    }

    function setupDecisionButtons() {
      const buttonsContainer = document.getElementById('decisionButtons');
      buttonsContainer.innerHTML = '';

      currentScenario.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.className = 'decision-btn';
        button.textContent = option.text;
        button.onclick = () => selectDecision(index);
        buttonsContainer.appendChild(button);
      });
    }

    function selectDecision(index) {
      selectedDecision = index;

      // Update button styles
      document.querySelectorAll('.decision-btn').forEach((btn, i) => {
        if (i === index) {
          btn.classList.add('selected');
        } else {
          btn.classList.remove('selected');
        }
      });
    }

    function startTimer() {
      clearInterval(timer);
      timer = setInterval(() => {
        if (!isPaused) {
          timeLeft--;
          updateTimer();

          if (timeLeft <= 0) {
            timeUp();
          }
        }
      }, 1000);
    }

    function updateTimer() {
      const timerElement = document.getElementById('timer');
      timerElement.textContent = timeLeft;

      if (timeLeft <= 30) {
        timerElement.classList.add('warning');
      } else {
        timerElement.classList.remove('warning');
      }
    }

    function timeUp() {
      clearInterval(timer);
      if (!selectedDecision) {
        selectedDecision = 0; // Default to first option
      }
      submitDecision();
    }

    function submitDecision() {
      if (selectedDecision === null) {
        alert("Please select a decision option!");
        return;
      }

      clearInterval(timer);

      const prompt = document.getElementById('promptInput').value;
      const decision = currentScenario.options[selectedDecision];

      // Calculate ethics score based on prompt quality and decision
      let roundScore = calculateEthicsScore(prompt, decision);
      ethicsScore += roundScore;

      showResults(prompt, decision, roundScore);
    }

    function calculateEthicsScore(prompt, decision) {
      let score = 0;

      // Base score for having a prompt
      if (prompt.length > 20) score += 5;

      // Bonus for ethical keywords
      const ethicalWords = ['fair', 'ethical', 'bias', 'harm', 'benefit', 'rights', 'justice', 'equal'];
      ethicalWords.forEach(word => {
        if (prompt.toLowerCase().includes(word)) score += 2;
      });

      // Bonus for considering multiple perspectives
      if (prompt.includes('consider') || prompt.includes('balance') || prompt.includes('weigh')) {
        score += 3;
      }

      // Decision-based scoring (subjective)
      score += Math.floor(Math.random() * 8) + 2; // 2-10 points

      return Math.min(score, 20); // Max 20 points per round
    }

    function showResults(prompt, decision, roundScore) {
      const resultsPanel = document.getElementById('resultsPanel');

      // Simulate voting results
      const votes = generateVoteResults();

      resultsPanel.innerHTML = `
        <h4>Round ${currentRound} Results</h4>
        <p><strong>Your Prompt:</strong> "${prompt || 'No prompt provided'}"</p>
        <p><strong>Your Decision:</strong> ${decision.text}</p>
        <p><strong>Round Score:</strong> ${roundScore}/20</p>

        <div class="vote-display">
          ${currentScenario.options.map((option, i) => `
            <div class="vote-option">
              <div class="vote-count">${votes[i]}%</div>
              <div>${option.text}</div>
            </div>
          `).join('')}
        </div>

        <div class="philosophical-insight">
          <strong>Philosophical Context:</strong> ${currentScenario.philosophy}
          <br><br>
          <strong>Real-World Impact:</strong> ${currentScenario.insight}
        </div>

        <button class="next-round-btn" onclick="nextRoundOrComplete()">
          ${currentRound < 5 ? 'NEXT DILEMMA' : 'VIEW FINAL RESULTS'}
        </button>
      `;

      resultsPanel.classList.remove('hidden');
    }

    function generateVoteResults() {
      // Generate realistic-looking vote distribution
      const votes = [];
      let total = 0;

      for (let i = 0; i < currentScenario.options.length; i++) {
        votes[i] = Math.floor(Math.random() * 30) + 15; // 15-45%
        total += votes[i];
      }

      // Normalize to 100%
      return votes.map(v => Math.round((v / total) * 100));
    }

    function nextRoundOrComplete() {
      currentRound++;
      if (currentRound <= 5) {
        nextRound();
      } else {
        gameComplete();
      }
    }

    function gameComplete() {
      gameState = 'complete';
      hideAllScreens();

      // Determine philosophical alignment
      let alignment = '';
      if (ethicsScore >= 80) {
        alignment = 'Ethical AI Pioneer';
      } else if (ethicsScore >= 60) {
        alignment = 'Thoughtful Technologist';
      } else if (ethicsScore >= 40) {
        alignment = 'Developing Ethicist';
      } else {
        alignment = 'Moral Student';
      }

      let insight = '';
      if (ethicsScore >= 80) {
        insight = 'üéì You demonstrate deep understanding of AI ethics and moral reasoning!';
      } else if (ethicsScore >= 60) {
        insight = 'ü§î You show good ethical intuition but can explore more perspectives.';
      } else {
        insight = 'üìö Continue studying AI ethics - these decisions shape our future!';
      }

      document.getElementById('finalEthicsScore').textContent = ethicsScore;
      document.getElementById('alignment').textContent = alignment;
      document.getElementById('finalInsight').textContent = insight;

      document.getElementById('gameOverScreen').classList.remove('hidden');
    }

    function updateUI() {
      document.getElementById('ethicsScore').textContent = ethicsScore;
    }

    // Event listeners
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (gameState === 'playing' && !isPaused) {
          pauseGame();
        } else if (isPaused) {
          resumeGame();
        }
      } else if (e.key === 'Enter' && e.ctrlKey && gameState === 'playing') {
        submitDecision();
      } else if (gameState === 'playing' && !isPaused) {
        // Keyboard shortcuts for decisions
        const num = parseInt(e.key);
        if (num >= 1 && num <= currentScenario.options.length) {
          selectDecision(num - 1);
        }
      }
    });
  </script>
</body>
</html>